<pre class = 'syntax code'><span class = 'syntax tag'>&lt;?php</span>

<span class = 'syntax var'>$users</span> <span class = 'syntax operator'>=</span> [];
<span class = 'syntax var'>$pocket</span> <span class = 'syntax operator'>=</span> <span class = 'syntax keyword'>new</span> <span class = 'syntax class'>Pocket</span>(
  <span class = 'syntax string'>'pocketjs.ml'</span>, <span class = 'syntax primitive'>8000</span>, <span class = 'syntax primitive'>20</span>
);

<span class = 'syntax var'>$pocket</span><span class = 'syntax operator'>-></span><span class = 'syntax method'>bind</span>(<span class = 'syntax string'>'username'</span>,
  <span class = 'syntax keyword'>function</span> (<span class = 'syntax var'>$username</span>, <span class = 'syntax var'>$id</span>) {
    <span class = 'syntax var'>$users</span>[<span class = 'syntax var'>$id</span>] <span class = 'syntax operator'>=</span> <span class = 'syntax embed_var'>$username</span>;
    <span class = 'syntax var'>$pocket</span><span class = 'syntax operator'>-></span><span class = 'syntax method'>send</span>(
      <span class = 'syntax string'>'username'</span>,
      <span class = 'syntax var'>$id</span>, <span class = 'syntax primitive'>true</span>,
      <span class = 'syntax var'>$username</span>
    );
});
<span class = 'syntax var'>$pocket</span><span class = 'syntax operator'>-></span><span class = 'syntax method'>bind</span>(<span class = 'syntax string'>'message'</span>,
  <span class = 'syntax keyword'>function</span> (<span class = 'syntax var'>$message</span>, <span class = 'syntax var'>$id</span>) {
    <span class = 'syntax var'>$pocket</span><span class = 'syntax operator'>-></span><span class = 'syntax method'>sendAll</span>(
      <span class = 'syntax string'>'message'</span>,
      <span class = 'syntax var'>$users</span>[<span class = 'syntax var'>$id</span>],
      <span class = 'syntax embed_var'>$message</span>,
      <span class = 'syntax var'>$id</span>
    );
});

<span class = 'syntax var'>$pocket</span><span class = 'syntax operator'>-></span><span class = 'syntax method'>open</span>();

<span class = 'syntax tag'>?></span>
</pre>
